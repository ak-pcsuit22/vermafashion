{% extends 'base.html' %}
{% block title %}Shop — Verma Fashions{% endblock %}
{% block content %}
  <h2>All Products</h2>
  <div class="products-grid">
    {% for p in products %}
      <div class="product-tile">
        {% if p.image_filename %}
          <a href="{{ url_for('product_detail', product_id=p.id) }}"><img src="/static/uploads/{{ p.image_filename }}" alt="{{ p.name }}"></a>
        {% else %}
          <div class="no-image"><a href="{{ url_for('product_detail', product_id=p.id) }}">No image</a></div>
        {% endif %}
        <div class="product-body">
          <h3><a href="{{ url_for('product_detail', product_id=p.id) }}">{{ p.name }}</a></h3>
          <p class="price">₹{{ '%.2f'|format(p.price) }}</p>
          <p class="desc">{{ p.description }}</p>
          {% if current_user.is_authenticated %}
            <form method="post" action="{{ url_for('cart_add') }}" style="display:inline-block">
              <input type="hidden" name="product_id" value="{{ p.id }}">
              <input type="number" name="quantity" value="1" min="1" style="width:60px">
              <button class="btn" type="submit">Add to Cart</button>
            </form>
          {% else %}
            <a class="btn" href="{{ url_for('login') }}">Login to Order</a>
          {% endif %}
          <div class="stock">Stock: {{ p.quantity }}</div>
        </div>
      </div>
    {% else %}
      <p>No products yet.</p>
    {% endfor %}
  </div>
{% endblock %}
